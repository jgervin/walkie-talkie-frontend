{"ast":null,"code":"import _classCallCheck from\"/Users/jn/code/walkie-talkie/walkie-talkie-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/jn/code/walkie-talkie/walkie-talkie-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/jn/code/walkie-talkie/walkie-talkie-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/jn/code/walkie-talkie/walkie-talkie-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/jn/code/walkie-talkie/walkie-talkie-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import'./App.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var _require=require('twilio-client'),Device=_require.Device;var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.state={identity:'',status:'',ready:false};_this.onChangeUpdateState=_this.onChangeUpdateState.bind(_assertThisInitialized(_this));_this.setup=_this.setup.bind(_assertThisInitialized(_this));_this.connect=_this.connect.bind(_assertThisInitialized(_this));_this.disconnect=_this.disconnect.bind(_assertThisInitialized(_this));return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var device=new Device();this.setState({device:device});device.on('incoming',function(connection){// immediately accepts incoming connection\nconnection.accept();_this2.setState({status:connection.status()});});device.on('ready',function(device){_this2.setState({status:\"device ready\",ready:true});});device.on('connect',function(connection){_this2.setState({status:connection.status()});});device.on('disconnect',function(connection){_this2.setState({status:connection.status()});});}// This method sets the identity of the Twilio Device\n// that your device is going to connect to. This\n// example uses hardcoded values so that only devices\n// with the identities friend1 and friend2 can connect.\n// In a production application, this would have to be\n// handled in a much different way. Most likely, the\n// app would have users who are authenticated with a\n// username and password. Their unique username would\n// serve as their device’s identity and they would only\n// be able to connect to device’s owned by users in their\n// friend list.\n},{key:\"connect\",value:function connect(){var recipient=this.state.identity==='friend1'?'friend2':'friend1';this.state.device.connect({recipient:recipient});}},{key:\"disconnect\",value:function disconnect(){this.state.device.disconnectAll();}},{key:\"setup\",value:function setup(event){var _this3=this;// prevents form submission and page refresh\nevent.preventDefault();fetch(\"https://walkie-talkie-service-5481-dev.twil.io/token?identity=\".concat(this.state.identity)).then(function(response){return response.json();}).then(function(data){_this3.state.device.setup(data.accessToken);_this3.state.device.audio.incoming(false);_this3.state.device.audio.outgoing(false);_this3.state.device.audio.disconnect(false);}).catch(function(err){return console.log(err);});}},{key:\"onChangeUpdateState\",value:function onChangeUpdateState(event){this.setState({identity:event.target.value});}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[this.state.ready?/*#__PURE__*/_jsx(\"button\",{onMouseDown:this.connect,onMouseUp:this.disconnect,children:\"Press to Talk\"}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:\"Enter your name to begin.\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:this.setup,children:[/*#__PURE__*/_jsx(\"input\",{value:this.state.identity,onChange:this.onChangeUpdateState,type:\"text\",placeholder:\"What's your name?\"}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Begin Session\"})]})]}),/*#__PURE__*/_jsx(\"p\",{children:this.state.status})]});}}]);return App;}(Component);export default App;","map":{"version":3,"sources":["/Users/jn/code/walkie-talkie/walkie-talkie-frontend/src/App.js"],"names":["React","Component","require","Device","App","props","state","identity","status","ready","onChangeUpdateState","bind","setup","connect","disconnect","device","setState","on","connection","accept","recipient","disconnectAll","event","preventDefault","fetch","then","response","json","data","accessToken","audio","incoming","outgoing","catch","err","console","log","target","value"],"mappings":"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","sourcesContent":["      import React, {Component} from 'react';\n      import './App.css';\n\n      const { Device } = require('twilio-client');\n\n      class App extends Component {\n        constructor(props) {\n          super(props)\n\n          this.state={\n            identity: '',\n            status: '',\n            ready: false\n          }\n\n          this.onChangeUpdateState = this.onChangeUpdateState.bind(this);\n          this.setup = this.setup.bind(this);\n          this.connect = this.connect.bind(this);\n          this.disconnect = this.disconnect.bind(this);\n        }\n\n        componentDidMount() {\n          const device = new Device();\n\n          this.setState({\n            device: device\n          });\n\n          device.on('incoming', connection => {\n        // immediately accepts incoming connection\n        connection.accept();\n\n            this.setState({\n              status: connection.status()\n            });\n          });\n\n          device.on('ready', device => {\n            this.setState({\n              status: \"device ready\",\n              ready: true\n            });\n          });\n\n          device.on('connect', connection => {\n            this.setState({\n              status: connection.status()\n            });\n          });\n\n          device.on('disconnect', connection => {\n            this.setState({\n              status: connection.status()\n            });\n          });\n        }\n\n        // This method sets the identity of the Twilio Device\n        // that your device is going to connect to. This\n        // example uses hardcoded values so that only devices\n        // with the identities friend1 and friend2 can connect.\n        // In a production application, this would have to be\n        // handled in a much different way. Most likely, the\n        // app would have users who are authenticated with a\n        // username and password. Their unique username would\n        // serve as their device’s identity and they would only\n        // be able to connect to device’s owned by users in their\n        // friend list.\n\n        connect() {\n          const recipient = this.state.identity === 'friend1' ? 'friend2' : 'friend1';\n          this.state.device.connect({recipient: recipient});\n        }\n\n        disconnect() {\n          this.state.device.disconnectAll();\n        }\n\n        setup(event) {\n        // prevents form submission and page refresh\n        event.preventDefault();\n\n        fetch(`https://walkie-talkie-service-5481-dev.twil.io/token?identity=${this.state.identity}`)\n          .then(response => response.json())\n          .then(data => {\n            this.state.device.setup(data.accessToken);\n            this.state.device.audio.incoming(false);\n            this.state.device.audio.outgoing(false);\n            this.state.device.audio.disconnect(false);\n          })\n          .catch(err => console.log(err))\n        }\n\n        onChangeUpdateState(event) {\n          this.setState({\n            identity: event.target.value\n          });\n        }\n\n        render() {\n          return (\n            <div className=\"App\">\n              {\n                this.state.ready\n                ? <button onMouseDown={this.connect}\n                          onMouseUp={this.disconnect}>\n                    Press to Talk\n                  </button>\n                : <div>\n                    <p>Enter your name to begin.</p>\n                    <form onSubmit={this.setup}>\n                      <input\n                        value={this.state.identity}\n                        onChange={this.onChangeUpdateState}\n                        type=\"text\"\n                        placeholder=\"What's your name?\"></input>\n                      <input type=\"submit\" value=\"Begin Session\"></input>\n                    </form>\n                  </div>\n              } \n              <p>{ this.state.status }</p>\n            </div>\n          );\n        }\n\n\n      }\n\n      export default App;\n"]},"metadata":{},"sourceType":"module"}